<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Demos - Virtualmodel - Recline Data Explorer and Library</title>

    <script type="text/javascript" src="../../vendor/jquery/jquery-1.8.2.js"></script>
<script type="text/javascript" src="../../vendor/jquery/jquery.1.2.1.ba-bbq.min.js"></script>
<script type="text/javascript" src="../../vendor/jQueryUi/jquery-ui-1.8.23.custom.js"></script>


<link type="text/css" href="../../vendor/jQueryUi/jquery-ui-1.8.23.custom.css" rel="stylesheet" />

<script type="text/javascript" src="../../vendor/jquery-slider/js/jquery.slider.js"></script>
<link type="text/css" href="../../vendor/jquery-slider/css/jquery.slider.min.css" rel="stylesheet" />


    
<!-- NVD3 & D3 libraries -->
<script type="text/javascript" src="../../vendor/d3/v2/d3.v2.min.js"></script>

<link rel="stylesheet" href="../../vendor/nvd3/0.0.1/nv.d3.css">

<script type="text/javascript" src="../../vendor/nvd3/0.0.1/nv.d3.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/tooltip.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/utils.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/models/legend.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/models/axis.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/models/scatter.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/models/line.js"></script>
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/models/lineChart.js"></script>


<!--<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/nv.d3.min.js"></script>-->

<!--
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/tooltip.js"></script>
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/utils.js"></script>
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/models/legend.js"></script>
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/models/axis.js"></script>
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/models/scatter.js"></script>
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/models/line.js"></script>
<script type="text/javascript" src="https://raw.github.com/Moviri/nvd3/master/src/models/lineChart.js"></script>


-->

    

<script type="text/javascript" src="../../vendor/underscore/1.3.3/underscore.js"></script>
<script type="text/javascript" src="../../vendor/backbone/0.9.2/backbone.js"></script>
<script type="text/javascript" src="../../vendor/mustache/0.5.0-dev/mustache.js"></script>


<script type="text/javascript" src="../../vendor/moment/1.6.2/moment.js"></script>
<script type="text/javascript" src="../../vendor/crossfilter/1.1.0/crossfilter.min.js"></script>
<script type="text/javascript" src="../../vendor/kartograph/unversioned/chroma.min.js"></script>

<script type="text/javascript" src="../../vendor/date/date.js"></script>

<!--
    ## Just use the all in one library version rather than individual files

  <script type="text/javascript" src="../../dist/recline.js"></script>

  -->

  <!-- model and backends -->
  <script type="text/javascript" src="../../src/model.js"></script>
  <script type="text/javascript" src="../../src/model/virtualmodel.js"></script>
  <script type="text/javascript" src="../../src/model/filteredmodel.js"></script>
  <script type="text/javascript" src="../../src/model/joinedmodel.js"></script>

  <script type="text/javascript" src="../../src/backend.memory.js"></script>
  <script type="text/javascript" src="../../src/backend.dataproxy.js"></script>
  <script type="text/javascript" src="../../src/backend.gdocs.js"></script>
  <script type="text/javascript" src="../../src/backend.elasticsearch.js"></script>
  <script type="text/javascript" src="../../src/backend.csv.js"></script>
  <script type="text/javascript" src="../../src/backend.jsonp.js"></script>

  <!-- views -->
  <script type="text/javascript" src="../../src/view.grid.js"></script>
  <script type="text/javascript" src="../../src/view.slickgrid.js"></script>
  <script type="text/javascript" src="../../src/view.transform.js"></script>
  <script type="text/javascript" src="../../src/view.graph.js"></script>
  <script type="text/javascript" src="../../src/view.map.js"></script>
  <script type="text/javascript" src="../../src/view.timeline.js"></script>
  <script type="text/javascript" src="../../src/view.multiview.js"></script>
  <script type="text/javascript" src="../../src/view.nvd3.graph.js"></script>
  <script type="text/javascript" src="../../src/view.indicator.js"></script>

  <script type="text/javascript" src="../../src/view.kartograph.js"></script>
  <script type="text/javascript" src="../../src/view.composed.js"></script>

  <script type="text/javascript" src="../../src/d3/view.d3.table.js"></script>
  <script type="text/javascript" src="../../src/d3/view.d3.sparkline.js"></script>
  <script type="text/javascript" src="../../src/d3/view.d3.treemap.js"></script>

  <script type="text/javascript" src="../../src/view.rickshaw.js"></script>

  <script type="text/javascript" src="../../src/data.transform.js"></script>
  <script type="text/javascript" src="../../src/data.aggregations.js"></script>
  <script type="text/javascript" src="../../src/data.formatters.js"></script>
  <script type="text/javascript" src="../../src/data.filters.js"></script>
  <script type="text/javascript" src="../../src/data.colors.js"></script>
  <script type="text/javascript" src="../../src/data.shapes.js"></script>
  <script type="text/javascript" src="../../src/data.statemanagement.js"></script>
  <script type="text/javascript" src="../../src/data.fieldsutilities.js"></script>

  <script type="text/javascript" src="../../src/widget.pager.js"></script>
  <script type="text/javascript" src="../../src/widget.queryeditor.js"></script>
  <script type="text/javascript" src="../../src/widget.filtereditor.js"></script>
  <script type="text/javascript" src="../../src/widget.fields.js"></script>
  <script type="text/javascript" src="../../src/widget.genericfilter.js"></script>
  <script type="text/javascript" src="../../src/widget.facetviewer.js"></script>
  <script type="text/javascript" src="../../src/widget.currentfilter.js"></script>
  <script type="text/javascript" src="../../src/widget.datepicker.js"></script>

  <script type="text/javascript" src="../../src/action.js"></script>

  <script type="text/javascript" src="../../src/template.shapes.js"></script>


    <script type="text/javascript" src="../../vendor/bootstrap/2.1.1/js/bootstrap.js"></script>
<link rel="stylesheet" href="../../vendor/bootstrap/2.1.1/css/moda/bootstrap.css" />

    <link rel="stylesheet" href="../../vendor/leaflet/0.4.4/leaflet.css">
<!--[if lte IE 8]>
<link rel="stylesheet" href="../../vendor/leaflet/0.4.4/leaflet.ie.css" />
<![endif]-->
<link rel="stylesheet" href="../../vendor/leaflet.markercluster/MarkerCluster.css">
<link rel="stylesheet" href="../../vendor/leaflet.markercluster/MarkerCluster.Default.css">
<!--[if lte IE 8]>
<link rel="stylesheet" href="../../vendor/leaflet.markercluster/MarkerCluster.Default.ie.css" />
<![endif]-->

 <script type="text/javascript" src="../../vendor/leaflet/0.4.4/leaflet.js"></script>


  <script type="text/javascript" src="../../vendor/leaflet/0.4.4/leaflet.js"></script>
  <script type="text/javascript" src="../../vendor/leaflet.markercluster/leaflet.markercluster.js"></script>


      <link rel="stylesheet" href="../../vendor/slickgrid/2.0.2/slick.grid.css">


  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/jquery.event.drag-2.0.min.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.grid.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.core.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.editors.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.formatters.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.cellrangeselector.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.cellselectionmodel.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.rowselectionmodel.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.grid.js"></script>



    
        <!-- raphael -->
<script type="text/javascript" src="../../vendor/raphael/2.1.0/raphael-min.js"></script>
        <!-- kartograph -->
<script type="text/javascript" src="../../vendor/kartograph/unversioned/kartograph.js"></script>


    <link rel="stylesheet" href="../../vendor/rickshaw/1.1.2/rickshaw.min.css">
<script type="text/javascript" src="../../vendor/rickshaw/1.1.2/rickshaw.min.js"></script>

        <!--
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Class.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Compat.ClassList.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.Area.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.Line.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.Bar.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.ScatterPlot.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.RangeSlider.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.HoverDetail.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Annotate.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Legend.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Axis.Time.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Behavior.Series.Toggle.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Behavior.Series.Order.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Behavior.Series.Highlight.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Smoother.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Unstacker.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.Time.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.Number.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.RandomData.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.Color.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Color.Palette.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Axis.Y.js"></script>
        -->


   
    <script type="text/javascript" src="../../vendor/chosen/chosen.jquery.min.js"></script>
<link rel="stylesheet" href="../../vendor/chosen/chosen.css" />

    <script type="text/javascript" src="../../vendor/datepicker/1.0.0/js/datepicker.js"></script>
<script type="text/javascript" src="../../vendor/datepicker/1.0.0/js/DateRange.js"></script>
<script type="text/javascript" src="../../vendor/datepicker/1.0.0/js/DateRangesWidget.js"></script>

<link rel="stylesheet" type="text/css" href="../../vendor/datepicker/1.0.0/css/datepicker/base.css" />
<link rel="stylesheet" type="text/css" href="../../vendor/datepicker/1.0.0/css/DateRangesWidget/base.css" />





</head>
<body>


<body>

<div class="container-fluid">
    <style>
        .bs {
            position: relative;
            margin: 15px 0;
            padding: 39px 19px 14px;
            background-color: white;
            border: 1px solid #DDD;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
        }

        .bs::after {
            content: "source dataset";
            position: absolute;
            top: -1px;
            left: -1px;
            padding: 3px 7px;
            font-size: 12px;
            font-weight: bold;
            background-color: whiteSmoke;
            border: 1px solid #DDD;
            color: #9DA0A4;
            -webkit-border-radius: 4px 0 4px 0;
            -moz-border-radius: 4px 0 4px 0;
            border-radius: 4px 0 4px 0;
        }

        .bs2 {
            position: relative;
            margin: 15px 0;
            padding: 39px 19px 14px;
            background-color: white;
            border: 1px solid #DDD;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
        }

        .bs2::after {
            content: "virtual dataset";
            position: absolute;
            top: -1px;
            left: -1px;
            padding: 3px 7px;
            font-size: 12px;
            font-weight: bold;
            background-color: whiteSmoke;
            border: 1px solid #DDD;
            color: #9DA0A4;
            -webkit-border-radius: 4px 0 4px 0;
            -moz-border-radius: 4px 0 4px 0;
            border-radius: 4px 0 4px 0;
        }

        .bs3 {
            position: relative;
            margin: 15px 0;
            padding: 39px 19px 14px;
            background-color: white;
            border: 1px solid #DDD;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
        }

        .bs3::after {
            content: "Resulting aggregated table";
            position: absolute;
            top: -1px;
            left: -1px;
            padding: 3px 7px;
            font-size: 12px;
            font-weight: bold;
            background-color: whiteSmoke;
            border: 1px solid #DDD;
            color: #9DA0A4;
            -webkit-border-radius: 4px 0 4px 0;
            -moz-border-radius: 4px 0 4px 0;
            border-radius: 4px 0 4px 0;
        }

        .border-free-table td, th {
            border: 0 !important;
        }
    </style>

    <div class="row-fluid">
        <div class="span3">
		    <div class="row-fluid">
	             <div class="bs">
	                 <div id="grid1" style="height: 30px;"></div>
	             </div>
            </div>
		    <div class="row-fluid">
<pre>
var agebin  = function(value, field, record) {
    var v = record.attributes["age"];
    if(v < 10)
     return " 1-10";
    else if(v < 20)
     return "11-20";
    return v;
}
</pre>
            </div>
		    <div class="row-fluid">
<pre>
var dataset = new recline.Model.Dataset({
   records:[
      {id:0, country:'Italy', gender:"Female", age:5, visits: 10},
      {id:1, country:'Italy', gender:"Female", age:5, visits: 20},
      {id:2, country:'Italy', gender:"Female", age:12, visits: 30},
      {id:3, country:'Italy', gender:"Male", age:13, visits: 40},
      {id:4, country:'France', gender:"Male", age:14, visits: 50}
     ],
   fields:[
      {id:'id'},
      {id:'country', type:'string'},
      {id:'gender',   type:'string'},
      {id:'age', type:'integer' },
      {id: 'agebin', type: 'integer', deriver: agebin},
      {id:'visits', type:'integer' }
     ]
});
                </pre>
            </div>
        </div>
        <div class="span4">
		    <div class="row-fluid">
	            <div class="bs2">
	                <div id="grid2" style="height: 30px;"></div>
	            </div>
	        </div>
		    <div class="row-fluid">
<pre>
var virtual1 = new recline.Model.VirtualDataset({
    dataset: dataset,
    aggregation: {
        dimensions:             ["country", "gender"],
        measures:               ["visits"],
        aggregationFunctions:   ["sum"],
        partitions:             ["agebin"]
    },
    totals: {
        measures:               ["visits_sum"],
        aggregationFunctions:   ["sum"]
    }
});
</pre>
	        </div>
        </div>
        <div class="span5">
		    <div class="row-fluid">
	            <div class="bs3">
	                <div id="grid3" style="height: 250px;"></div>
	            </div>
		    </div>
		    <div class="row-fluid">
    <pre>
var grid3 = new recline.View.SlickGrid({
    model:virtual1,
    el:$el,
    state:{
        fitColumns:true,
        useHoverStyle:true,
        useStripedStyle:true,
        useCondensedStyle:true,
		showPartitionedData: {
        	measures:      [ {field: "visits", aggregation: "sum" } ],
        	partition:     "agebin",
        	showSubTotals: true
        },
        showTotals: [ {field: "visits_sum", aggregation: "sum" } ]
    }

});
    </pre>
   		</div>
</div>
</div>
</div>

<script>

    var agebin = function (value, field, record) {
        var v = record.attributes["age"];
        if (v < 10)
            return " 1-10";
        else if (v < 20)
            return "11-20";

        return v;
    }

    var dataset = new recline.Model.Dataset({
        records:[
            {id:0, country:'Italy', gender:"Female", age:5,  visits: 10},
            {id:1, country:'Italy', gender:"Female", age:5,  visits: 20},
            {id:2, country:'Italy', gender:"Female", age:12, visits: 30},
            {id:3, country:'Italy', gender:"Male",   age:13, visits: 40},
            {id:4, country:'Italy', gender:"Male",   age:14, visits: 50}
        ],

        fields:[
            {id:'id'},
            {id:'country', type:'string'},
            {id:'gender', type:'string'},
            {id:'age', type:'integer' },
            {id:'agebin', type:'integer', deriver:agebin},
            {id:'visits', type:'integer' }
        ]
    });

   var virtual1 = new recline.Model.VirtualDataset(
            {
                dataset: dataset,
                aggregation: {
                    dimensions:             ["country", "gender"],
                    measures:               ["visits"],
                    aggregationFunctions:   ["sum"],
                    partitions:             ["agebin"]
                },
                totals: {
                    measures:               ["visits_sum"],
                    aggregationFunctions:   ["sum"]
                }
    });


    var $el = $('#grid1');
    var grid1 = new recline.View.SlickGrid({
        model:dataset,
        el:$el,
        state:{  fitColumns:true,
            useHoverStyle:true,
            useStripedStyle:true,
            useCondensedStyle:true
        }

    });
    grid1.visible = true;
    grid1.render();

    $el = $('#grid2');
    var grid2 = new recline.View.SlickGrid({
        model:virtual1,
        el:$el,
        state:{
            fitColumns:true,
            useHoverStyle:true,
            useStripedStyle:true,
            useCondensedStyle:true,
            showTotals: [ {field: "visits_sum", aggregation: "sum" } ]
        }

    });
    grid2.visible = true;
    grid2.render();


    $el = $('#grid3');
    var grid3 = new recline.View.SlickGrid({
        model:virtual1,
        el:$el,
        state:{
            fitColumns:true,
            useHoverStyle:true,
            useStripedStyle:true,
            useCondensedStyle:true,
    		showPartitionedData: {
            	measures:               [{field: "visits", aggregation: "sum" }],
            	partition:             "agebin",
            	showSubTotals: true
            },
            showTotals: [ {field: "visits_sum", aggregation: "sum" } ]
        }

    });
    grid3.visible = true;
    grid3.render();
    
</script>

</body>




</body>
</html>
