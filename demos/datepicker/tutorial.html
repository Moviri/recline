<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Demos - DatePicker</title>

    <!-- jQuery + jQuery UI deps -->
<script type="text/javascript" src="../../vendor/jquery/jquery-1.8.2.js"></script>
<script type="text/javascript" src="../../vendor/jquery/jquery.1.2.1.ba-bbq.min.js"></script>
<script type="text/javascript" src="../../vendor/jQueryUi/jquery-ui-1.8.23.custom.js"></script>

<link type="text/css" href="../../vendor/jQueryUi/jquery-ui-1.8.23.custom.css" rel="stylesheet" />

<script type="text/javascript" src="../../vendor/jquery-slider/js/jquery.slider.min.js"></script>
<link type="text/css" href="../../vendor/jquery-slider/css/jquery.slider.min.css" rel="stylesheet" />

<script type="text/javascript" src="../../vendor/date/date.js"></script>

    
<!-- NVD3 & D3 libraries -->
<script type="text/javascript" src="../../vendor/d3/v2/d3.v2.custom.js"></script>
<link rel="stylesheet" href="../../vendor/nvd3/0.0.1/nv.d3.css">
<script type="text/javascript" src="../../vendor/nvd3/0.0.1/nv.d3.js"></script>
<script type="text/javascript" src="../../vendor/d3.layouts/cloud.js"></script>

    <!-- D3 choropleth maps deps -->
<script type="text/javascript" src="../../vendor/d3/v3/d3.v3.js"></script>
<script type="text/javascript" src="../../vendor/d3/v3/topojson.v0.min.js"></script>
<script type="text/javascript" src="../../vendor/toAscii/toAscii.js"></script>

    <!-- recline deps -->
<script type="text/javascript" src="../../vendor/underscore/1.3.3/underscore.js"></script>
<script type="text/javascript" src="../../vendor/underscore.deferred/0.4.0/underscore.deferred.js"></script>
<script type="text/javascript" src="../../vendor/backbone/0.9.2/backbone.js"></script>
<script type="text/javascript" src="../../vendor/mustache/0.5.0-dev/mustache.js"></script>
<script type="text/javascript" src="../../vendor/accounting/accounting.js"></script>

<script type="text/javascript" src="../../vendor/moment/1.6.2/moment.js"></script>
<script type="text/javascript" src="../../vendor/crossfilter/1.1.0/crossfilter.min.js"></script>
<script type="text/javascript" src="../../vendor/kartograph/unversioned/chroma.min.js"></script>

<script type="text/javascript" src="../..//dist/recline.dataset.js"></script>
<script type="text/javascript" src="../..//dist/recline.js"></script>
<script type="text/javascript" src="../..//dist/recline.extensions.js"></script>

    <!--  bootstrap deps -->
<script type="text/javascript" src="../../vendor/bootstrap/2.3.1/js/bootstrap.js"></script>
<link rel="stylesheet" href="../../vendor/bootstrap/2.3.1/css/bootstrap.css" />
<link rel="stylesheet" href="../../vendor/bootstrap/2.3.1/css/bootstrap.extensions.css" />

    <!--  bootstrap multiselect deps -->
<script type="text/javascript" src="../../vendor/bootstrap-multiselect/bootstrap-multiselect.js"></script>
<link href='../../vendor/bootstrap-multiselect/bootstrap-multiselect.css' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="../../vendor/leaflet/0.4.4/leaflet.css">
<!--[if lte IE 8]>
<link rel="stylesheet" href="../../vendor/leaflet/0.4.4/leaflet.ie.css" />
<![endif]-->
<link rel="stylesheet" href="../../vendor/leaflet.markercluster/MarkerCluster.css">
<link rel="stylesheet" href="../../vendor/leaflet.markercluster/MarkerCluster.Default.css">
<!--[if lte IE 8]>
<link rel="stylesheet" href="../../vendor/leaflet.markercluster/MarkerCluster.Default.ie.css" />
<![endif]-->

  <script type="text/javascript" src="../../vendor/leaflet/0.4.4/leaflet.js"></script>
  <script type="text/javascript" src="../../vendor/leaflet.markercluster/leaflet.markercluster.js"></script>


    <script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places" type="text/javascript"></script>
<script type="text/javascript" src="../../vendor/google-maps/markerclusterer.js"></script>

    <!-- SlickGrid deps -->
  <link rel="stylesheet" href="../../vendor/slickgrid/2.0.2/slick.grid.css">

  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/jquery.event.drag-2.0.min.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.grid.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.core.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.editors.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.formatters.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.cellrangeselector.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.cellselectionmodel.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.rowselectionmodel.js"></script>
  <script type="text/javascript" src="../../vendor/slickgrid/2.0.2/slick.grid.js"></script>



    
        <!-- raphael -->
<script type="text/javascript" src="../../vendor/raphael/2.1.0/raphael-min.js"></script>
        <!-- kartograph -->
<script type="text/javascript" src="../../vendor/kartograph/unversioned/kartograph.js"></script>


    <link rel="stylesheet" href="../../vendor/rickshaw/1.1.2/rickshaw.min.css">
<script type="text/javascript" src="../../vendor/rickshaw/1.1.2/rickshaw.min.js"></script>

        <!--
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Class.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Compat.ClassList.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.Area.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.Line.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.Bar.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Renderer.ScatterPlot.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.RangeSlider.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.HoverDetail.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Annotate.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Legend.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Axis.Time.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Behavior.Series.Toggle.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Behavior.Series.Order.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Behavior.Series.Highlight.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Smoother.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Unstacker.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.Time.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.Number.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.RandomData.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Fixtures.Color.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Color.Palette.js"></script>
<script src="../../vendor/rickshaw/1.1.2/src/Rickshaw.Graph.Axis.Y.js"></script>
        -->

    <!-- xCharts deps -->
<link rel="stylesheet" href="../../vendor/xcharts/xcharts.css">
<script type="text/javascript" src="../../vendor/xcharts/xcharts.js"></script>


   
    <script type="text/javascript" src="../../vendor/chosen/chosen.jquery.min.js"></script>
<link rel="stylesheet" href="../../vendor/chosen/chosen.css" />

    <script type="text/javascript" src="../../vendor/datepicker/1.0.0/js/datepicker.js"></script>
<script type="text/javascript" src="../../vendor/datepicker/1.0.0/js/DateRange.js"></script>
<script type="text/javascript" src="../../vendor/datepicker/1.0.0/js/DateRangesWidget.js"></script>

<link rel="stylesheet" type="text/css" href="../../vendor/datepicker/1.0.0/css/datepicker/base.css" />
<link rel="stylesheet" type="text/css" href="../../vendor/datepicker/1.0.0/css/DateRangesWidget/base.css" />


    <!-- codemirror deps -->
		<script type="text/javascript" src="../../vendor/codemirror/js/codemirror.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/htmlmixed.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/xml.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/css.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/javascript.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/closetag.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/closebrackets.js"></script>
		<!-- script type="text/javascript" src="../../vendor/codemirror/js/html-hint.js"></script-->
		<!-- script type="text/javascript" src="../../vendor/codemirror/js/javascript-hint.js"></script-->
		<script type="text/javascript" src="../../vendor/codemirror/js/matchbrackets.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/foldcode.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/brace-fold.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/indent-fold.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/xml-fold.js"></script>
		
		<script type="text/javascript" src="../../vendor/codemirror/js/lint.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/javascript-lint.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/json-lint.js"></script>
		<script type="text/javascript" src="../../vendor/codemirror/js/jshint-1.1.0.js"></script>
		
		<link href="../../vendor/codemirror/css/codemirror.css" rel="stylesheet" type="text/css">
		<link href="../../vendor/codemirror/css/show-hint.css" rel="stylesheet" type="text/css">
		<link href="../../vendor/codemirror/css/lint.css" rel="stylesheet" type="text/css">
		
    
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-36323657-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>


</head>
<body>


<div class="row-fluid">
    <div class="span3" style="height: 50px;">
       Select period <div id="filter_period"></div>
    </div>


</div>
<div class="row-fluid">
    <div class="span3">
        </div>
    <div class="span3">
        <div id="currentfilters"></div>

    </div>
    <div class="span3">
        compare
        <div id="currentfilters_compare"></div>
    </div>
</div>
<div class="row-fluid">
    <div class="span3">

    </div>
    <div class="span3">
        <div id="grid" style="height: 600px;"></div>
    </div>
    <div class="span3">
    <div id="grid_compare" style="height: 600px;"></div>
    </div>
</div>

<script>
    var dataset = new recline.Model.Dataset({
        records:[
            {id:1,  date:new Date(2012, 9, 1, 9, 0, 0, 0), periodtype: "month"},
            {id:2,  date:new Date(2012, 9, 2, 10, 0, 0, 0), periodtype: "year"},
            {id:3,  date:new Date(2012, 9, 3, 11, 0, 0, 0), periodtype: "year"},
            {id:4,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "year"},
            {id:5,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:6,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:7,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:8,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:9,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:10, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:11, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:12, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "month"},
            {id:13, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:14, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:15, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "month"},
            {id:16, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:17, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:18, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:19, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "month"}


        ],
        fields:[
            {id:'date', type:"date"},
            {id:'periodtype', type:"string"}
        ]
    });

    var dataset_compare = new recline.Model.Dataset({
        records:[
            {id:1,  date:new Date(2012, 9, 1, 9, 0, 0, 0), periodtype: "month"},
            {id:2,  date:new Date(2012, 9, 2, 10, 0, 0, 0), periodtype: "year"},
            {id:3,  date:new Date(2012, 9, 3, 11, 0, 0, 0), periodtype: "year"},
            {id:4,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "year"},
            {id:5,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:6,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:7,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:8,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:9,  date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:10, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:11, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:12, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "month"},
            {id:13, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:14, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "day"},
            {id:15, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "month"},
            {id:16, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:17, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:18, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "week"},
            {id:19, date:new Date(2012, 9, 4, 12, 0, 0, 0), periodtype: "month"}


        ],
        fields:[
            {id:'date', type:"date"},
            {id:'periodtype', type:"string"}
        ]
    });

    var dateFilter = {field: "date", type: "range", start:new Date(2012,9,01,00,00,00,0), stop:new Date(2012,9,3,00,00,00,0), fieldType: "date" };
    var compareFilter = {field: "date", type: "range", start:new Date(2012,8,01,00,00,00,0), stop:new Date(2012,8,3,00,00,00,0), fieldType: "date" };
    dataset.queryState.addFilter(dateFilter);
    dataset.query();

    dataset_compare.queryState.addFilter(compareFilter);
    dataset_compare.query();

    var action = new recline.Action({
        filters:{
            filter_date_range:      {type:"range", field:"date", fieldType:"date"},
            filter_date_rangetype:  {type:"term", field:"periodtype", fieldType:"string"}
        },
        models:[
            {
                model:dataset,
                filters:["filter_date_range", "filter_date_rangetype"]
            }
        ],
        type:["filter"]
    });

    var action_compare = new recline.Action({
        filters:{
            filter_date_range:{type:"range", field:"date", fieldType:"date"},
            filter_date_rangetype:  {type:"term", field:"periodtype", fieldType:"string"}
        },
        models:[
            {
                model:dataset_compare,
                filters:["filter_date_range", "filter_date_rangetype"]
            }
        ],
        type:["filter"]
    });


    var filter_period = new recline.View.DatePicker({
        model: dataset,
        fields: {date: "date", type: "periodtype"},
        compareModel: dataset_compare,
        compareFields: {date: "date", type: "periodtype"},
        actions:[
            {
                action:action,
                mapping:[
                    {srcField:"date", filter:"filter_date_range"},
                    {srcField:"rangetype", filter:"filter_date_rangetype"}
                ],
                event:["selection"]
            },
            {
                action:action_compare,
                mapping:[
                    {srcField:"date", filter:"filter_date_range"},
                    {srcField:"rangetype", filter:"filter_date_rangetype"}
                ],
                event:["selection_compare"]
            }
        ]
    });
    $('#filter_period').append(filter_period.el);
    filter_period.render();



    var $el = $('#grid');
    var grid1 = new recline.View.SlickGridGraph({
        model:dataset,
        el:$el,
        state: {
            fitColumns:true,
            useHoverStyle: true,
            useStripedStyle: true,
            useCondensedStyle: true,
            showLineNumbers: true
        }
    });
    grid1.visible = true;
    grid1.render();

    var $el = $('#grid_compare');
    var grid2 = new recline.View.SlickGridGraph({
        model:dataset_compare,
        el:$el,
        state: {
            fitColumns:true,
            useHoverStyle: true,
            useStripedStyle: true,
            useCondensedStyle: true,
            showLineNumbers: true
        }
    });
    grid2.visible = true;
    grid2.render();

    var $el = $('#currentfilters');
    var currentfilters = new recline.View.CurrentFilter({
        models:[dataset],
        el:$el
    });
    currentfilters.render();

    var $el = $('#currentfilters_compare');
    var currentfilters_compare = new recline.View.CurrentFilter({
        models:[dataset_compare],
        el:$el
    });
    currentfilters_compare.render();

</script>


</body>
</html>
